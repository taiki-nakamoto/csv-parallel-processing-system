# AWSリソース命名規則ガイドライン

## 1. 概要

### 1.1 目的
CSVファイル並列処理システムにおけるAWSリソースの命名規則を統一し、保守性・可読性・一貫性を向上させる。

### 1.2 適用範囲
- Lambda関数
- S3バケット
- IAMロール・ポリシー
- Step Functions ステートマシン
- CloudWatch関連リソース
- EventBridge ルール
- DynamoDB テーブル
- Aurora データベース・テーブル
- VPC関連リソース

### 1.3 基本原則
1. **一貫性**: 同種リソースは同一の命名パターンを使用
2. **可読性**: 名前から機能・用途が推測可能
3. **一意性**: 同一AWSアカウント内で重複しない
4. **簡潔性**: 必要十分な情報を最小限の文字数で表現

## 2. 全体的な命名規則

### 2.1 基本構造
```
{project-prefix}-{function-name}-{resource-type}
```

### 2.2 共通要素
- **プロジェクトプレフィックス**: `csv`
- **区切り文字**: ハイフン（`-`）
- **文字種**: 小文字・数字・ハイフンのみ使用
- **アカウント固有要素**: `{account-id}`（必要に応じて）

### 2.3 禁止事項
- アンダースコア（`_`）の使用（データベース関連を除く）
- キャメルケース
- 大文字の使用
- 日本語文字
- 特殊文字（ハイフン以外）

## 3. リソース別命名規則

### 3.1 Lambda関数

#### 命名パターン
```
csv-{function-name}
```

#### 具体例
| 機能 | 関数名 |
|------|--------|
| CSV統合処理 | `csv-processor` |

### 3.2 S3バケット

#### 命名パターン
```
csv-{purpose}-{account-id}
```

#### 具体例
| 用途 | バケット名 |
|------|-----------|
| 入力ファイル | `csv-input-{account-id}` |
| 出力ファイル | `csv-output-{account-id}` |
| アーカイブ | `csv-archive-{account-id}` |
| ログ保存 | `csv-logs-{account-id}` |
| 処理結果 | `csv-results-{account-id}` |

### 3.3 IAMロール

#### 命名パターン
```
csv-{service}-{function}-role
```

#### 具体例
| サービス・機能 | ロール名 |
|----------------|----------|
| Step Functions実行 | `csv-stepfunctions-execution-role` |
| Lambda CSV検証 | `csv-lambda-validator-role` |
| Lambda チャンク処理 | `csv-lambda-chunk-processor-role` |
| Lambda 統合処理 | `csv-lambda-processor-role` |
| EventBridge実行 | `csv-eventbridge-execution-role` |
| S3レプリケーション | `csv-s3-replication-role` |

### 3.4 IAMポリシー

#### 命名パターン
```
csv-{resource}-{permission}-policy
```

#### 具体例
| リソース・権限 | ポリシー名 |
|----------------|------------|
| Lambda呼び出し | `csv-lambda-invoke-policy` |
| S3アクセス | `csv-s3-access-policy` |
| DynamoDBアクセス | `csv-dynamodb-access-policy` |
| Auroraアクセス | `csv-aurora-access-policy` |
| CloudWatch書き込み | `csv-cloudwatch-write-policy` |

### 3.5 Step Functions

#### 命名パターン
```
csv-{workflow-name}
```

#### 具体例
| ワークフロー | ステートマシン名 |
|-------------|-----------------|
| メインワークフロー | `csv-main-workflow` |
| 並列処理ワークフロー | `csv-parallel-workflow` |

### 3.6 CloudWatch

#### ロググループ命名パターン
```
/aws/{service}/csv-{function-name}
```

#### アラーム命名パターン
```
csv-{resource}-{metric}-alarm
```

#### 具体例
| リソース | 名前 |
|----------|------|
| Step Functionsログ | `/aws/stepfunctions/csv-main-workflow` |
| Lambda ログ | `/aws/lambda/csv-processor` |
| エラー率アラーム | `csv-lambda-validator-error-rate-alarm` |
| 実行時間アラーム | `csv-stepfunctions-duration-alarm` |

### 3.7 EventBridge

#### 命名パターン
```
csv-{trigger-source}-{action}-rule
```

#### 具体例
| ルール | 名前 |
|--------|------|
| S3アップロード処理 | `csv-s3-upload-trigger-rule` |

### 3.8 DynamoDB

#### 命名パターン
```
csv-{table-purpose}
```

#### 具体例
| テーブル用途 | テーブル名 |
|-------------|-----------|
| 処理ログ | `csv-logs` |
| エラーログ | `csv-errors` |

### 3.9 Aurora

#### 命名パターン
- **クラスター**: `csv-cluster`
- **データベース**: `csv_db`
- **テーブル**: `{table_purpose}` (アンダースコア区切り)

#### 具体例
| リソース | 名前 |
|----------|------|
| クラスター | `csv-cluster` |
| データベース | `csv_db` |
| ユーザーログテーブル | `user_logs` |
| 処理ログテーブル | `processing_logs` |

### 3.10 VPC関連

#### 命名パターン
```
csv-{resource-type}-{purpose}
```

#### 具体例
| リソース | 名前 |
|----------|------|
| VPC | `csv-vpc` |
| パブリックサブネット | `csv-subnet-public-1a` |
| プライベートサブネット | `csv-subnet-private-1a` |
| Lambdaセキュリティグループ | `csv-sg-lambda` |
| Auroraセキュリティグループ | `csv-sg-aurora` |
| インターネットゲートウェイ | `csv-igw` |
| NATゲートウェイ | `csv-natgw-1a` |

## 4. 環境別命名規則

### 4.1 環境識別子
| 環境 | 識別子 |
|------|--------|
| 開発 | `dev` |
| ステージング | `stg` |
| 本番 | `prod` |

### 4.2 環境別命名パターン
```
csv-{env}-{resource-name}
```

#### 具体例
- 開発環境Lambda: `csv-dev-validator`
- 本番環境S3バケット: `csv-prod-input-{account-id}`

## 5. タグ付け規則

### 5.1 必須タグ
| タグキー | 説明 | 例 |
|----------|------|-----|
| Project | プロジェクト名 | `csv` |
| Environment | 環境 | `prod` |
| Component | コンポーネント種別 | `lambda`, `s3`, `stepfunctions` |
| Owner | 担当チーム | `data-processing-team` |
| CostCenter | コストセンター | `engineering` |

### 5.2 オプションタグ
| タグキー | 説明 | 例 |
|----------|------|-----|
| Version | バージョン | `v1.0.0` |
| BackupRequired | バックアップ要否 | `true` |
| Monitoring | 監視要否 | `true` |

## 6. リソース名一覧表

### 6.1 Lambda関数
| 機能 | 統一後の関数名 |
|------|----------------|
| CSV統合処理 | `csv-processor` |

### 6.2 S3バケット
| 用途 | 統一後のバケット名 |
|------|-------------------|
| 入力ファイル | `csv-input-{account-id}` |
| 出力ファイル | `csv-output-{account-id}` |
| アーカイブ | `csv-archive-{account-id}` |
| ログ保存 | `csv-logs-{account-id}` |
| 処理結果 | `csv-results-{account-id}` |

### 6.3 IAMロール
| 用途 | 統一後のロール名 |
|------|------------------|
| Step Functions実行 | `csv-stepfunctions-execution-role` |
| Lambda実行（共通） | `csv-lambda-execution-role` |
| EventBridge実行 | `csv-eventbridge-execution-role` |

### 6.4 Step Functions
| ワークフロー | 統一後のステートマシン名 |
|-------------|------------------------|
| メインワークフロー | `csv-main-workflow` |

### 6.5 CloudWatch
| リソース | 統一後の名前 |
|----------|--------------|
| Step Functionsログ | `/aws/stepfunctions/csv-main-workflow` |
| Lambda ログ | `/aws/lambda/csv-{function-name}` |

### 6.6 EventBridge
| ルール | 統一後の名前 |
|--------|--------------|
| S3アップロード処理 | `csv-s3-upload-trigger-rule` |

### 6.7 DynamoDB
| テーブル | 統一後の名前 |
|----------|--------------|
| 処理ログ | `csv-logs` |

### 6.8 Aurora
| リソース | 統一後の名前 |
|----------|--------------|
| クラスター | `csv-cluster` |
| データベース | `csv_db` |

### 6.9 VPC関連
| リソース | 統一後の名前 |
|----------|--------------|
| VPC | `csv-vpc` |
| Lambdaセキュリティグループ | `csv-sg-lambda` |
| Auroraセキュリティグループ | `csv-sg-aurora` |

## 7. 実装時の注意事項

### 7.1 既存リソースの対応
1. 新規作成時は本ガイドラインに準拠
2. 既存リソースは段階的にリネーム
3. 破壊的変更が必要な場合は慎重に計画

### 7.2 設計書更新
1. 基本設計書・詳細設計書の関数名を統一
2. CloudFormation/Terraformテンプレートの更新
3. 運用手順書の更新

### 7.3 検証方法
1. リソース作成前の命名規則チェック
2. デプロイ後の実際のリソース名確認
3. タグ付けの整合性確認

## 8. 運用・メンテナンス

### 8.1 定期確認
- 月次でのリソース名確認
- 新規リソース追加時の命名規則適用確認
- タグ付けの整合性確認

### 8.2 例外対応
- AWS制約による命名制限がある場合の対応方針
- 既存システムとの連携で命名変更が困難な場合の対応

### 8.3 更新管理
- 命名規則変更時の影響範囲確認
- 変更履歴の管理
- 関連ドキュメントの同期更新

---

**文書管理情報**
- 作成日: 2025-08-03
- 版数: v1.0
- 承認者: プロジェクトマネージャー
- 次回見直し: プロジェクト完了後