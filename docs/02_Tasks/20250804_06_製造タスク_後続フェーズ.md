# CSVãƒ•ã‚¡ã‚¤ãƒ«ä¸¦åˆ—å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ  è£½é€ ã‚¿ã‚¹ã‚¯_å¾Œç¶šãƒ•ã‚§ãƒ¼ã‚º

## 1. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæƒ…å ±

| é …ç›® | å†…å®¹ |
|------|------|
| ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå | è£½é€ ã‚¿ã‚¹ã‚¯_å¾Œç¶šãƒ•ã‚§ãƒ¼ã‚º |
| ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | 1.0 |
| ä½œæˆæ—¥ | 2025-08-04 |
| ä½œæˆè€… | ã‚·ã‚¹ãƒ†ãƒ é–‹ç™ºãƒãƒ¼ãƒ  |
| æ›´æ–°æ—¥ | 2025-08-04 |
| åˆ†å‰²å…ƒ | 20250804_01_è£½é€ ã‚¿ã‚¹ã‚¯ç®¡ç†.md |

## 2. å¾Œç¶šãƒ•ã‚§ãƒ¼ã‚ºæ¦‚è¦

### 2.1 å¾Œç¶šãƒ•ã‚§ãƒ¼ã‚ºã®ä½ç½®ä»˜ã‘
é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ãƒ•ã‚§ãƒ¼ã‚ºå®Œäº†å¾Œã®æ®µéšã¨ã—ã¦ã€ä»¥ä¸‹ã®å¾Œç¶šãƒ•ã‚§ãƒ¼ã‚ºã‚’å®Ÿæ–½ã—ã¾ã™ï¼š

1. **ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è£½é€ ãƒ•ã‚§ãƒ¼ã‚º**: Lambdaé–¢æ•°ãƒ»Step Functionsãƒ»APIå®Ÿè£…
2. **ãƒ†ã‚¹ãƒˆè£½é€ ãƒ•ã‚§ãƒ¼ã‚º**: å˜ä½“ãƒ»çµ±åˆãƒ»E2Eãƒ†ã‚¹ãƒˆå®Ÿè£…
3. **ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ãƒªãƒªãƒ¼ã‚¹ãƒ•ã‚§ãƒ¼ã‚º**: é–‹ç™ºãƒ»æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤
4. **é‹ç”¨æº–å‚™ãƒ•ã‚§ãƒ¼ã‚º**: é‹ç”¨æ‰‹é †æ›¸ãƒ»åˆ©ç”¨è€…å‘ã‘ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ

### 2.2 å‚ç…§ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- **é–‹ç™ºç’°å¢ƒæ§‹ç¯‰å®Œäº†**: `20250804_14_è£½é€ ã‚¿ã‚¹ã‚¯_é–‹ç™ºç’°å¢ƒæ§‹ç¯‰.md`
- **Lambdaé–‹ç™ºæ¨™æº–**: `02-01_åŸºæœ¬è¨­è¨ˆæ›¸_Lambdaé–‹ç™ºæ¨™æº–ä»•æ§˜æ›¸.md`
- **è©³ç´°è¨­è¨ˆæ›¸**: `03-06_è©³ç´°è¨­è¨ˆæ›¸_CSVçµ±åˆå‡¦ç†é–¢æ•°.md`
- **Step Functionsè¨­è¨ˆ**: `03-02_è©³ç´°è¨­è¨ˆæ›¸_Step Functionsè©³ç´°è¨­è¨ˆ.md`
- **APIè¨­è¨ˆ**: `03-13_è©³ç´°è¨­è¨ˆæ›¸_APIè©³ç´°è¨­è¨ˆ.md`

## 3. ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è£½é€ ãƒ•ã‚§ãƒ¼ã‚º â³æœªç€æ‰‹

### 3.1 çµ±åˆLambdaé–¢æ•°å®Ÿè£… â³æœªç€æ‰‹

#### csv-processoré–¢æ•°åŸºç›¤å®Ÿè£… â³æœªç€æ‰‹
**å‚ç…§**: 03-06_è©³ç´°è¨­è¨ˆæ›¸_CSVçµ±åˆå‡¦ç†é–¢æ•°.md

- [ ] **ãƒ¡ã‚¤ãƒ³ãƒãƒ³ãƒ‰ãƒ©ãƒ¼å®Ÿè£…**ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆç¨®åˆ¥ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼‰
  ```typescript
  // src/index.ts
  export const handler = async (event: any, context: Context): Promise<any> => {
    const container = new DIContainer();
    const eventRouter = container.get<EventRouter>('EventRouter');
    
    try {
      return await eventRouter.route(event, context);
    } catch (error) {
      logger.error('Handler execution failed', { error, event });
      throw error;
    }
  };
  ```

- [ ] **ã‚¤ãƒ™ãƒ³ãƒˆãƒ‘ãƒ¼ã‚µãƒ¼å®Ÿè£…**
  ```typescript
  // src/controllers/EventParser.ts
  export class EventParser {
    public parseEvent(event: any): ProcessingEvent {
      if (this.isS3Event(event)) {
        return this.parseS3Event(event);
      } else if (this.isStepFunctionsEvent(event)) {
        return this.parseStepFunctionsEvent(event);
      }
      throw new Error('Unsupported event type');
    }
  }
  ```

- [ ] **DI ã‚³ãƒ³ãƒ†ãƒŠè¨­å®š**
  ```typescript
  // src/infrastructure/config/DIContainer.ts
  export class DIContainer {
    private container: Container;
    
    constructor() {
      this.container = new Container();
      this.registerServices();
    }
    
    private registerServices(): void {
      // Serviceç™»éŒ²
      this.container.bind<ICsvValidationService>('CsvValidationService')
        .to(CsvValidationService);
    }
  }
  ```

- [ ] **ãƒ­ã‚°è¨­å®š**ï¼ˆæ§‹é€ åŒ–ãƒ­ã‚°ï¼‰
  ```typescript
  // src/infrastructure/config/Logger.ts
  export class StructuredLogger {
    public info(message: string, meta?: object): void {
      console.log(JSON.stringify({
        timestamp: new Date().toISOString(),
        level: 'INFO',
        message,
        ...meta
      }));
    }
  }
  ```

- [ ] **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°åŸºç›¤**
  ```typescript
  // src/infrastructure/error/ErrorHandler.ts
  export class GlobalErrorHandler {
    public handleError(error: Error, context: any): ProcessingResult {
      if (error instanceof ValidationError) {
        return this.handleValidationError(error, context);
      } else if (error instanceof DatabaseError) {
        return this.handleDatabaseError(error, context);
      }
      return this.handleUnknownError(error, context);
    }
  }
  ```

#### CSVæ¤œè¨¼æ©Ÿèƒ½å®Ÿè£… (CSV_VALIDATION) â³æœªç€æ‰‹
- [ ] **CSVValidationControllerå®Ÿè£…**
  ```typescript
  // src/controllers/CsvValidationController.ts
  export class CsvValidationController {
    constructor(
      private csvValidationService: ICsvValidationService
    ) {}
    
    public async validate(event: S3Event): Promise<ValidationResult> {
      const s3Object = this.extractS3Object(event);
      return await this.csvValidationService.validateCsv(s3Object);
    }
  }
  ```

- [ ] **CSVValidationServiceå®Ÿè£…**ï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼‰
  ```typescript
  // src/application/services/CsvValidationService.ts
  export class CsvValidationService implements ICsvValidationService {
    constructor(
      private csvValidator: ICsvValidator,
      private validationRepository: IValidationRepository
    ) {}
    
    public async validateCsv(s3Object: S3Object): Promise<ValidationResult> {
      const csvData = await this.validationRepository.getCsvData(s3Object);
      return await this.csvValidator.validate(csvData);
    }
  }
  ```

- [ ] **CSVValidatorå®Ÿè£…**ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼‰
  ```typescript
  // src/domain/validators/CsvValidator.ts
  export class CsvValidator implements ICsvValidator {
    public async validate(csvData: CsvData): Promise<ValidationResult> {
      const errors: ValidationError[] = [];
      
      // ãƒ˜ãƒƒãƒ€ãƒ¼æ¤œè¨¼
      errors.push(...this.validateHeaders(csvData.headers));
      
      // ãƒ‡ãƒ¼ã‚¿è¡Œæ¤œè¨¼
      errors.push(...this.validateDataRows(csvData.rows));
      
      return new ValidationResult(errors.length === 0, errors);
    }
  }
  ```

- [ ] **ValidationRepositoryå®Ÿè£…**ï¼ˆã‚¤ãƒ³ãƒ•ãƒ©å±¤ï¼‰
  ```typescript
  // src/infrastructure/repositories/S3ValidationRepository.ts
  export class S3ValidationRepository implements IValidationRepository {
    constructor(private s3Client: S3Client) {}
    
    public async getCsvData(s3Object: S3Object): Promise<CsvData> {
      const response = await this.s3Client.getObject({
        Bucket: s3Object.bucket,
        Key: s3Object.key
      });
      
      return this.parseCsvStream(response.Body);
    }
  }
  ```

#### ãƒãƒ£ãƒ³ã‚¯å‡¦ç†æ©Ÿèƒ½å®Ÿè£… (CSV_CHUNK_PROCESSING) â³æœªç€æ‰‹
- [ ] **ChunkProcessingControllerå®Ÿè£…**
- [ ] **ChunkProcessingServiceå®Ÿè£…**
- [ ] **ChunkProcessorå®Ÿè£…**ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼‰
- [ ] **DataRepositoryå®Ÿè£…**ï¼ˆAuroraæ¥ç¶šï¼‰

#### ç›£æŸ»ãƒ­ã‚°æ©Ÿèƒ½å®Ÿè£… (AUDIT_LOGGING) â³æœªç€æ‰‹
- [ ] **AuditLoggingControllerå®Ÿè£…**
- [ ] **AuditLoggingServiceå®Ÿè£…**
- [ ] **AuditLoggerå®Ÿè£…**ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼‰
- [ ] **AuditRepositoryå®Ÿè£…**ï¼ˆDynamoDBæ¥ç¶šï¼‰

#### çµæœé›†ç´„æ©Ÿèƒ½å®Ÿè£… (RESULT_AGGREGATION) â³æœªç€æ‰‹
- [ ] **ResultAggregationControllerå®Ÿè£…**
- [ ] **ResultAggregationServiceå®Ÿè£…**
- [ ] **ResultAggregatorå®Ÿè£…**ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼‰
- [ ] **ResultRepositoryå®Ÿè£…**

#### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ©Ÿèƒ½å®Ÿè£… (ERROR_HANDLING) â³æœªç€æ‰‹
- [ ] **ErrorHandlingControllerå®Ÿè£…**
- [ ] **ErrorHandlingServiceå®Ÿè£…**
- [ ] **ErrorHandlerå®Ÿè£…**ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼‰
- [ ] **ErrorRepositoryå®Ÿè£…**

### 3.2 Lambda Layerså®Ÿè£… â³æœªç€æ‰‹

#### å…±é€šãƒ©ã‚¤ãƒ–ãƒ©ãƒªLayer â³æœªç€æ‰‹
- [ ] **å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°**
  ```typescript
  // layers/common-layer/src/utils/DateUtils.ts
  export class DateUtils {
    public static toISOString(date: Date): string {
      return date.toISOString();
    }
    
    public static addDays(date: Date, days: number): Date {
      const result = new Date(date);
      result.setDate(result.getDate() + days);
      return result;
    }
  }
  ```

- [ ] **AWS SDK Wrapper**
  ```typescript
  // layers/common-layer/src/aws/S3ClientWrapper.ts
  export class S3ClientWrapper {
    private s3Client: S3Client;
    
    constructor() {
      this.s3Client = new S3Client({ region: process.env.AWS_REGION });
    }
    
    public async getObject(bucket: string, key: string): Promise<GetObjectCommandOutput> {
      return await this.s3Client.send(new GetObjectCommand({ Bucket: bucket, Key: key }));
    }
  }
  ```

- [ ] **ãƒ­ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**
- [ ] **ãƒ¡ãƒˆãƒªã‚¯ã‚¹é€ä¿¡ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**

#### ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯Layer â³æœªç€æ‰‹
- [ ] **CSVå‡¦ç†å…±é€šãƒ­ã‚¸ãƒƒã‚¯**
- [ ] **ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å…±é€šãƒ­ã‚¸ãƒƒã‚¯**
- [ ] **ãƒ‡ãƒ¼ã‚¿å¤‰æ›å…±é€šãƒ­ã‚¸ãƒƒã‚¯**

### 3.3 Step Functionså®Ÿè£… â³æœªç€æ‰‹

#### ãƒ¡ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè£… â³æœªç€æ‰‹
**å‚ç…§**: 03-02_è©³ç´°è¨­è¨ˆæ›¸_Step Functionsè©³ç´°è¨­è¨ˆ.md

- [ ] **ASLï¼ˆAmazon States Languageï¼‰å®šç¾©ä½œæˆ**
  ```json
  {
    "Comment": "CSV Parallel Processing Workflow",
    "StartAt": "ValidateCSV",
    "States": {
      "ValidateCSV": {
        "Type": "Task",
        "Resource": "arn:aws:lambda:ap-northeast-1:526636471122:function:csv-processor",
        "Parameters": {
          "operation": "CSV_VALIDATION",
          "input.$": "$"
        },
        "Next": "IsValidationSuccessful"
      },
      "IsValidationSuccessful": {
        "Type": "Choice",
        "Choices": [{
          "Variable": "$.validation.isValid",
          "BooleanEquals": true,
          "Next": "ProcessCSVInParallel"
        }],
        "Default": "HandleValidationError"
      },
      "ProcessCSVInParallel": {
        "Type": "Map",
        "ItemProcessor": {
          "ProcessorConfig": {
            "Mode": "DISTRIBUTED",
            "ExecutionType": "STANDARD"
          },
          "StartAt": "ProcessChunk",
          "States": {
            "ProcessChunk": {
              "Type": "Task",
              "Resource": "arn:aws:lambda:ap-northeast-1:526636471122:function:csv-processor",
              "Parameters": {
                "operation": "CSV_CHUNK_PROCESSING",
                "chunk.$": "$"
              },
              "End": true
            }
          }
        },
        "Next": "AggregateResults"
      }
    }
  }
  ```

- [ ] **åˆ†æ•£ãƒãƒƒãƒ—è¨­å®š**
- [ ] **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°è¨­å®š**
- [ ] **å†è©¦è¡Œãƒãƒªã‚·ãƒ¼è¨­å®š**

### 3.4 APIå®Ÿè£… â³æœªç€æ‰‹

#### ç®¡ç†APIå®Ÿè£… â³æœªç€æ‰‹
**å‚ç…§**: 03-13_è©³ç´°è¨­è¨ˆæ›¸_APIè©³ç´°è¨­è¨ˆ.md

- [ ] **Step Functionså®Ÿè¡Œç®¡ç†API**
  ```typescript
  // src/controllers/StepFunctionsController.ts
  export class StepFunctionsController {
    public async startExecution(request: StartExecutionRequest): Promise<ExecutionResponse> {
      const input = {
        bucket: request.bucket,
        key: request.key,
        executionId: uuidv4()
      };
      
      const result = await this.stepFunctionsClient.startExecution({
        stateMachineArn: process.env.STATE_MACHINE_ARN,
        input: JSON.stringify(input)
      });
      
      return new ExecutionResponse(result.executionArn, input.executionId);
    }
  }
  ```

- [ ] **å®Ÿè¡ŒçŠ¶æ³ç›£è¦–API**
- [ ] **ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†API**
- [ ] **ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯API**

### 3.5 ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è£½é€ å®Ÿè¡Œé †åºï¼ˆæ¨å®šæ™‚é–“: 20æ™‚é–“ï¼‰

#### Phase 1: åŸºç›¤å®Ÿè£…ï¼ˆ6æ™‚é–“ï¼‰
1. **DIã‚³ãƒ³ãƒ†ãƒŠãƒ»ãƒ­ã‚°ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°åŸºç›¤** (3æ™‚é–“)
2. **ãƒ¡ã‚¤ãƒ³ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆãƒ‘ãƒ¼ã‚µãƒ¼** (3æ™‚é–“)

#### Phase 2: æ©Ÿèƒ½å®Ÿè£…ï¼ˆ10æ™‚é–“ï¼‰
1. **CSVæ¤œè¨¼æ©Ÿèƒ½** (3æ™‚é–“)
2. **ãƒãƒ£ãƒ³ã‚¯å‡¦ç†æ©Ÿèƒ½** (3æ™‚é–“)
3. **ç›£æŸ»ãƒ­ã‚°æ©Ÿèƒ½** (2æ™‚é–“)
4. **çµæœé›†ç´„ãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ©Ÿèƒ½** (2æ™‚é–“)

#### Phase 3: Layerãƒ»Step Functionsãƒ»APIï¼ˆ4æ™‚é–“ï¼‰
1. **Lambda Layerså®Ÿè£…** (2æ™‚é–“)
2. **Step Functions ASLå®šç¾©** (1æ™‚é–“)
3. **ç®¡ç†APIå®Ÿè£…** (1æ™‚é–“)

## 4. ãƒ†ã‚¹ãƒˆè£½é€ ãƒ•ã‚§ãƒ¼ã‚º â³æœªç€æ‰‹

### 4.1 å˜ä½“ãƒ†ã‚¹ãƒˆå®Ÿè£… â³æœªç€æ‰‹

#### Lambdaé–¢æ•°å˜ä½“ãƒ†ã‚¹ãƒˆ â³æœªç€æ‰‹
- [ ] **Controllerå±¤ãƒ†ã‚¹ãƒˆ**
  ```typescript
  // tests/unit/controllers/CsvValidationController.test.ts
  describe('CsvValidationController', () => {
    let controller: CsvValidationController;
    let mockService: jest.Mocked<ICsvValidationService>;
    
    beforeEach(() => {
      mockService = createMockCsvValidationService();
      controller = new CsvValidationController(mockService);
    });
    
    it('should validate CSV successfully', async () => {
      // ãƒ†ã‚¹ãƒˆå®Ÿè£…
    });
  });
  ```

- [ ] **Serviceå±¤ãƒ†ã‚¹ãƒˆ**
- [ ] **Domainå±¤ãƒ†ã‚¹ãƒˆ**
- [ ] **Repositoryå±¤ãƒ†ã‚¹ãƒˆ**ï¼ˆãƒ¢ãƒƒã‚¯ä½¿ç”¨ï¼‰

#### ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ä½œæˆ â³æœªç€æ‰‹
- [ ] **ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ä½œæˆãƒ˜ãƒ«ãƒ‘ãƒ¼**
  ```typescript
  // tests/helpers/TestDataBuilder.ts
  export class TestDataBuilder {
    public static createS3Event(bucket: string, key: string): S3Event {
      return {
        Records: [{
          s3: {
            bucket: { name: bucket },
            object: { key: key }
          }
        }]
      };
    }
  }
  ```

- [ ] **ãƒ¢ãƒƒã‚¯ä½œæˆãƒ˜ãƒ«ãƒ‘ãƒ¼**
- [ ] **ãƒ†ã‚¹ãƒˆç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**

### 4.2 çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè£… â³æœªç€æ‰‹

#### AWS ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ â³æœªç€æ‰‹
- [ ] **S3é€£æºãƒ†ã‚¹ãƒˆ**
  ```typescript
  // tests/integration/s3-integration.test.ts
  describe('S3 Integration', () => {
    it('should read CSV file from S3', async () => {
      // å®Ÿéš›ã®S3ãƒã‚±ãƒƒãƒˆã‚’ä½¿ç”¨ã—ãŸçµ±åˆãƒ†ã‚¹ãƒˆ
    });
  });
  ```

- [ ] **DynamoDBé€£æºãƒ†ã‚¹ãƒˆ**
- [ ] **Auroraé€£æºãƒ†ã‚¹ãƒˆ**
- [ ] **Step Functionsé€£æºãƒ†ã‚¹ãƒˆ**

### 4.3 E2Eãƒ†ã‚¹ãƒˆå®Ÿè£… â³æœªç€æ‰‹

#### ã‚¨ãƒ³ãƒ‰ãƒ»ãƒ„ãƒ¼ãƒ»ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆ â³æœªç€æ‰‹
- [ ] **CSVã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â†’ å‡¦ç†å®Œäº†ã¾ã§ã®å…¨ä½“ãƒ†ã‚¹ãƒˆ**
- [ ] **ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ**
- [ ] **æ€§èƒ½ãƒ†ã‚¹ãƒˆ**
- [ ] **è² è·ãƒ†ã‚¹ãƒˆ**ï¼ˆä¸¦åˆ—å‡¦ç†ï¼‰

### 4.4 ãƒ†ã‚¹ãƒˆè£½é€ å®Ÿè¡Œé †åºï¼ˆæ¨å®šæ™‚é–“: 8æ™‚é–“ï¼‰

#### Phase 1: å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆ4æ™‚é–“ï¼‰
1. **ãƒ†ã‚¹ãƒˆãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ä½œæˆ** (1æ™‚é–“)
2. **Controllerãƒ»Serviceå±¤ãƒ†ã‚¹ãƒˆ** (2æ™‚é–“)
3. **Domainãƒ»Repositoryå±¤ãƒ†ã‚¹ãƒˆ** (1æ™‚é–“)

#### Phase 2: çµ±åˆãƒ†ã‚¹ãƒˆï¼ˆ3æ™‚é–“ï¼‰
1. **AWS ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆãƒ†ã‚¹ãƒˆ** (2æ™‚é–“)
2. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºãƒ†ã‚¹ãƒˆ** (1æ™‚é–“)

#### Phase 3: E2Eãƒ†ã‚¹ãƒˆï¼ˆ1æ™‚é–“ï¼‰
1. **ã‚¨ãƒ³ãƒ‰ãƒ»ãƒ„ãƒ¼ãƒ»ã‚¨ãƒ³ãƒ‰ã‚·ãƒŠãƒªã‚ªãƒ†ã‚¹ãƒˆ** (1æ™‚é–“)

## 5. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ãƒªãƒªãƒ¼ã‚¹ãƒ•ã‚§ãƒ¼ã‚º â³æœªç€æ‰‹

### 5.1 é–‹ç™ºç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤ â³æœªç€æ‰‹

#### é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ â³æœªç€æ‰‹
- [ ] **Terraform Apply**ï¼ˆé–‹ç™ºç’°å¢ƒï¼‰
  ```bash
  cd terraform/environments/dev
  terraform init
  terraform plan -out=tfplan
  terraform apply tfplan
  ```

- [ ] **SAM Deploy**ï¼ˆé–‹ç™ºç’°å¢ƒï¼‰
  ```bash
  cd sam
  sam build --use-container
  sam deploy --config-env dev
  ```

- [ ] **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–**
  ```bash
  # Aurora PostgreSQL åˆæœŸã‚¹ã‚­ãƒ¼ãƒé©ç”¨
  psql -h $DATABASE_HOST -U $DATABASE_USER -d $DATABASE_NAME -f scripts/init-schema.sql
  
  # DynamoDB ãƒ†ãƒ¼ãƒ–ãƒ«åˆæœŸè¨­å®šç¢ºèª
  aws dynamodb describe-table --table-name csv-audit-logs-dev
  ```

- [ ] **å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆ**
  ```bash
  # API ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
  curl -f https://api-dev.example.com/health
  
  # ã‚µãƒ³ãƒ—ãƒ«CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»å‡¦ç†ãƒ†ã‚¹ãƒˆ
  aws s3 cp sample.csv s3://csv-input-files-526636471122-dev/
  ```

### 5.2 æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤ â³æœªç€æ‰‹

#### æœ¬ç•ªç’°å¢ƒæº–å‚™ â³æœªç€æ‰‹
- [ ] **æœ¬ç•ªç’°å¢ƒã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰**
  ```bash
  cd terraform/environments/prod
  terraform init
  terraform plan -out=tfplan
  terraform apply tfplan
  ```

- [ ] **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šç¢ºèª**
  - IAMãƒ­ãƒ¼ãƒ«æœ€å°æ¨©é™ç¢ºèª
  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚°ãƒ«ãƒ¼ãƒ—è¨­å®šç¢ºèª
  - S3ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼ç¢ºèª

- [ ] **ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šç¢ºèª**
  - CloudWatchã‚¢ãƒ©ãƒ¼ãƒ å‹•ä½œç¢ºèª
  - SNSé€šçŸ¥è¨­å®šç¢ºèª
  - X-Rayãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ç¢ºèª

- [ ] **ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¨­å®š**
  - Auroraè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª
  - DynamoDBãƒã‚¤ãƒ³ãƒˆã‚¤ãƒ³ã‚¿ã‚¤ãƒ ãƒªã‚«ãƒãƒªç¢ºèª

#### æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ â³æœªç€æ‰‹
- [ ] **Blue/Green ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ**
  ```bash
  cd sam
  sam deploy --config-env prod
  ```

- [ ] **å‹•ä½œç¢ºèªãƒ†ã‚¹ãƒˆ**
- [ ] **æ€§èƒ½ãƒ†ã‚¹ãƒˆ**
- [ ] **ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ç¢ºèª**

### 5.3 ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ãƒªãƒªãƒ¼ã‚¹å®Ÿè¡Œé †åºï¼ˆæ¨å®šæ™‚é–“: 4æ™‚é–“ï¼‰

#### Phase 1: é–‹ç™ºç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆ2æ™‚é–“ï¼‰
1. **ã‚¤ãƒ³ãƒ•ãƒ©ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»Lambda ãƒ‡ãƒ—ãƒ­ã‚¤** (1æ™‚é–“)
2. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–ãƒ»å‹•ä½œç¢ºèª** (1æ™‚é–“)

#### Phase 2: æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆ2æ™‚é–“ï¼‰
1. **æœ¬ç•ªç’°å¢ƒæº–å‚™ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºèª** (1æ™‚é–“)
2. **æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»å‹•ä½œç¢ºèª** (1æ™‚é–“)

## 6. é‹ç”¨æº–å‚™ãƒ•ã‚§ãƒ¼ã‚º â³æœªç€æ‰‹

### 6.1 é‹ç”¨æ‰‹é †æ›¸ä½œæˆ â³æœªç€æ‰‹

#### ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †æ›¸ä½œæˆ â³æœªç€æ‰‹
**æ ¼ç´å…ˆ**: 10_Manual/

- [ ] **01_ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †æ›¸.md**
  ```markdown
  # ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †æ›¸
  
  ## 1. äº‹å‰æº–å‚™
  - [ ] AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ»æ¨©é™ç¢ºèª
  - [ ] GitHub Actions Secretsç¢ºèª
  - [ ] ãƒ‡ãƒ—ãƒ­ã‚¤å¯¾è±¡ãƒ–ãƒ©ãƒ³ãƒç¢ºèª
  
  ## 2. é–‹ç™ºç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤
  ### 2.1 ã‚¤ãƒ³ãƒ•ãƒ©ãƒ‡ãƒ—ãƒ­ã‚¤
  ```bash
  cd terraform/environments/dev
  terraform plan -out=tfplan
  terraform apply tfplan
  ```
  
  ### 2.2 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ—ãƒ­ã‚¤
  ```bash
  cd sam
  sam build --use-container
  sam deploy --config-env dev
  ```
  ```

- [ ] **02_ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †æ›¸.md**
- [ ] **03_è¨­å®šå¤‰æ›´æ‰‹é †æ›¸.md**

#### ç›£è¦–ãƒ»é‹ç”¨æ‰‹é †æ›¸ä½œæˆ â³æœªç€æ‰‹
- [ ] **04_ç›£è¦–æ‰‹é †æ›¸.md**
  ```markdown
  # ç›£è¦–æ‰‹é †æ›¸
  
  ## 1. æ—¥æ¬¡ç›£è¦–é …ç›®
  - [ ] Lambdaé–¢æ•°å®Ÿè¡ŒçŠ¶æ³ç¢ºèª
  - [ ] Step Functionså®Ÿè¡ŒçŠ¶æ³ç¢ºèª
  - [ ] Aurora PostgreSQLæ¥ç¶šçŠ¶æ³ç¢ºèª
  - [ ] DynamoDBä½¿ç”¨é‡ç¢ºèª
  - [ ] S3ãƒã‚±ãƒƒãƒˆä½¿ç”¨é‡ç¢ºèª
  
  ## 2. é€±æ¬¡ç›£è¦–é …ç›®
  - [ ] ã‚³ã‚¹ãƒˆä½¿ç”¨é‡ãƒ¬ãƒ“ãƒ¥ãƒ¼
  - [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ã‚°ãƒ¬ãƒ“ãƒ¥ãƒ¼
  - [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ¬ãƒ“ãƒ¥ãƒ¼
  ```

- [ ] **05_ã‚¢ãƒ©ãƒ¼ãƒˆå¯¾å¿œæ‰‹é †æ›¸.md**
- [ ] **06_ãƒ­ã‚°åˆ†ææ‰‹é †æ›¸.md**

#### éšœå®³å¯¾å¿œæ‰‹é †æ›¸ä½œæˆ â³æœªç€æ‰‹
- [ ] **07_éšœå®³å¯¾å¿œæ‰‹é †æ›¸.md**
- [ ] **08_å¾©æ—§æ‰‹é †æ›¸.md**
- [ ] **09_ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ‰‹é †æ›¸.md**

### 6.2 åˆ©ç”¨è€…å‘ã‘ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ â³æœªç€æ‰‹

#### APIä»•æ§˜æ›¸ä½œæˆ â³æœªç€æ‰‹
- [ ] **OpenAPI 3.0 ä»•æ§˜æ›¸**
  ```yaml
  openapi: 3.0.0
  info:
    title: CSV Parallel Processing API
    version: 1.0.0
    description: CSVãƒ•ã‚¡ã‚¤ãƒ«ä¸¦åˆ—å‡¦ç†ã‚·ã‚¹ãƒ†ãƒ  API
  
  paths:
    /process-csv:
      post:
        summary: CSVå‡¦ç†é–‹å§‹
        requestBody:
          required: true
          content:
            application/json:
              schema:
                type: object
                properties:
                  bucket:
                    type: string
                  key:
                    type: string
        responses:
          '200':
            description: å‡¦ç†é–‹å§‹æˆåŠŸ
  ```

- [ ] **Postmanã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³**
- [ ] **ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰**

#### ã‚·ã‚¹ãƒ†ãƒ åˆ©ç”¨æ‰‹é †æ›¸ä½œæˆ â³æœªç€æ‰‹
- [ ] **CSVã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ‰‹é †**
- [ ] **å‡¦ç†çŠ¶æ³ç¢ºèªæ‰‹é †**
- [ ] **ã‚¨ãƒ©ãƒ¼å¯¾å¿œæ‰‹é †**

### 6.3 é‹ç”¨æº–å‚™å®Ÿè¡Œé †åºï¼ˆæ¨å®šæ™‚é–“: 6æ™‚é–“ï¼‰

#### Phase 1: é‹ç”¨æ‰‹é †æ›¸ä½œæˆï¼ˆ4æ™‚é–“ï¼‰
1. **ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †æ›¸** (2æ™‚é–“)
2. **ç›£è¦–ãƒ»éšœå®³å¯¾å¿œæ‰‹é †æ›¸** (2æ™‚é–“)

#### Phase 2: åˆ©ç”¨è€…å‘ã‘ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ2æ™‚é–“ï¼‰
1. **APIä»•æ§˜æ›¸ãƒ»ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰** (1æ™‚é–“)
2. **ã‚·ã‚¹ãƒ†ãƒ åˆ©ç”¨æ‰‹é †æ›¸** (1æ™‚é–“)

## 7. å…¨ä½“é€²æ—ç®¡ç†

### 7.1 ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥é€²æ—çŠ¶æ³
- ğŸ”´ **ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è£½é€ ãƒ•ã‚§ãƒ¼ã‚º**: 0% (æœªç€æ‰‹) - æ¨å®š20æ™‚é–“
- ğŸ”´ **ãƒ†ã‚¹ãƒˆè£½é€ ãƒ•ã‚§ãƒ¼ã‚º**: 0% (æœªç€æ‰‹) - æ¨å®š8æ™‚é–“
- ğŸ”´ **ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ãƒªãƒªãƒ¼ã‚¹ãƒ•ã‚§ãƒ¼ã‚º**: 0% (æœªç€æ‰‹) - æ¨å®š4æ™‚é–“
- ğŸ”´ **é‹ç”¨æº–å‚™ãƒ•ã‚§ãƒ¼ã‚º**: 0% (æœªç€æ‰‹) - æ¨å®š6æ™‚é–“

**åˆè¨ˆæ¨å®šæ™‚é–“**: **38æ™‚é–“**

### 7.2 ãƒªã‚¹ã‚¯ãƒ»èª²é¡Œ

#### æŠ€è¡“çš„ãƒªã‚¹ã‚¯
- **LambdaåŒæ™‚å®Ÿè¡Œæ•°åˆ¶é™**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ1000ã®åˆ¶é™ã«ã‚ˆã‚‹å‡¦ç†èƒ½åŠ›ä¸Šé™
- **Step Functionsåˆ†æ•£ãƒãƒƒãƒ—åˆ¶é™**: 1å›ã®å®Ÿè¡Œã§æœ€å¤§10,000ã‚¢ã‚¤ãƒ†ãƒ 
- **Aurora Serverlessèµ·å‹•æ™‚é–“**: åˆå›èµ·å‹•æ™‚ã®é…å»¶ï¼ˆæœ€å¤§30ç§’ï¼‰
- **VPCå†…Lambdaå®Ÿè¡Œ**: ENIä½œæˆã«ã‚ˆã‚‹åˆå›å®Ÿè¡Œé…å»¶ï¼ˆæœ€å¤§10ç§’ï¼‰

#### è¨­è¨ˆãƒ»å®Ÿè£…ãƒªã‚¹ã‚¯
- **DDD ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**: è¤‡é›‘ãªè¨­è¨ˆã«ã‚ˆã‚‹å®Ÿè£…å·¥æ•°å¢—åŠ 
- **TypeScriptå‹å®‰å…¨æ€§**: å³å¯†ãªå‹ãƒã‚§ãƒƒã‚¯ã«ã‚ˆã‚‹é–‹ç™ºé€Ÿåº¦ã¸ã®å½±éŸ¿
- **ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**: é«˜å“è³ªç¶­æŒã®ãŸã‚ã®ååˆ†ãªãƒ†ã‚¹ãƒˆå®Ÿè£…

#### é‹ç”¨ãƒªã‚¹ã‚¯
- **ã‚³ã‚¹ãƒˆç®¡ç†**: Aurora Serverlessã€DynamoDBã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰èª²é‡‘ã®äºˆæ¸¬å›°é›£
- **ç›£è¦–ä½“åˆ¶**: 24æ™‚é–“ç›£è¦–ä½“åˆ¶ã®æ§‹ç¯‰è¦å¦
- **éšœå®³å¯¾å¿œ**: åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ ã§ã®éšœå®³åˆ‡ã‚Šåˆ†ã‘ãƒ»å¯¾å¿œã®è¤‡é›‘æ€§

### 7.3 æˆåŠŸè¦å› 
- **æ®µéšçš„å®Ÿè£…**: ãƒ•ã‚§ãƒ¼ã‚ºã”ã¨ã®ç¢ºå®Ÿãªå®Ÿè£…ãƒ»ãƒ†ã‚¹ãƒˆ
- **è‡ªå‹•åŒ–**: CI/CDã«ã‚ˆã‚‹å“è³ªæ‹…ä¿ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤åŠ¹ç‡åŒ–
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™**: é‹ç”¨ãƒ»ä¿å®ˆã‚’è€ƒæ…®ã—ãŸè©³ç´°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- **å“è³ªé‡è¦–**: ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆé–‹ç™ºã«ã‚ˆã‚‹é«˜å“è³ªç¢ºä¿

## 8. é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### 8.1 å‰æ®µéšãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `20250804_14_è£½é€ ã‚¿ã‚¹ã‚¯_é–‹ç™ºç’°å¢ƒæ§‹ç¯‰.md` - é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ï¼ˆå‰æ®µéšï¼‰

### 8.2 åˆ†å‰²å…ƒãƒ»é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `20250804_01_è£½é€ ã‚¿ã‚¹ã‚¯ç®¡ç†.md` - å…ƒã®çµ±åˆã‚¿ã‚¹ã‚¯ç®¡ç†
- `20250804_11_è£½é€ ã‚¿ã‚¹ã‚¯_AWSç’°å¢ƒæº–å‚™.md` - AWSç’°å¢ƒæº–å‚™
- `20250804_12_è£½é€ ã‚¿ã‚¹ã‚¯_GitHubç’°å¢ƒæº–å‚™.md` - GitHubç’°å¢ƒæº–å‚™
- `20250804_13_è£½é€ ã‚¿ã‚¹ã‚¯_ã‚¤ãƒ³ãƒ•ãƒ©è£½é€ .md` - ã‚¤ãƒ³ãƒ•ãƒ©è£½é€ 

### 8.3 å‚ç…§è¨­è¨ˆæ›¸
- `02-01_åŸºæœ¬è¨­è¨ˆæ›¸_Lambdaé–‹ç™ºæ¨™æº–ä»•æ§˜æ›¸.md` - Lambdaé–‹ç™ºæ¨™æº–
- `03-06_è©³ç´°è¨­è¨ˆæ›¸_CSVçµ±åˆå‡¦ç†é–¢æ•°.md` - Lambdaé–¢æ•°è©³ç´°è¨­è¨ˆ
- `03-02_è©³ç´°è¨­è¨ˆæ›¸_Step Functionsè©³ç´°è¨­è¨ˆ.md` - Step Functionsè¨­è¨ˆ
- `03-13_è©³ç´°è¨­è¨ˆæ›¸_APIè©³ç´°è¨­è¨ˆ.md` - APIè¨­è¨ˆ
- `02-09_åŸºæœ¬è¨­è¨ˆæ›¸_CI-CDè¨­è¨ˆæ›¸.md` - CI/CDè¨­è¨ˆ

---

**æœ€çµ‚æ›´æ–°**: 2025-08-04  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: â³å¾Œç¶šãƒ•ã‚§ãƒ¼ã‚ºæœªç€æ‰‹  
**æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è£½é€ ãƒ•ã‚§ãƒ¼ã‚ºé–‹å§‹  
**æ¨å®šä½œæ¥­æ™‚é–“**: 38æ™‚é–“  
**é‡è¦**: é–‹ç™ºç’°å¢ƒæ§‹ç¯‰å®Œäº†å¾Œã«å®Ÿæ–½é–‹å§‹